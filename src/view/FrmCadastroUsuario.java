/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package view;

import control.TextSize;
import dao.DaoFuncionario;
import dao.DaoUsuario;
import java.awt.Color;
import java.awt.Toolkit;
import java.sql.SQLException;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;
import model.Funcionario;
import model.Usuario;

/**
 *
 * @author Luiz
 */
public class FrmCadastroUsuario extends javax.swing.JFrame {

    boolean flagFuncionario;

    /**
     * Creates new form FrmCadastroUsuario
     */
    public FrmCadastroUsuario(int nvlAdm) {
        initComponents();
        if (nvlAdm == 0) {
            btnCadastrar.setEnabled(false);
        }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        pnlDadosFuncionario = new javax.swing.JPanel();
        btnCadastrar = new javax.swing.JButton();
        btnLimpar = new javax.swing.JButton();
        lblFuncionario = new javax.swing.JLabel();
        btnListarFuncionarios = new javax.swing.JButton();
        panDadosFunc = new javax.swing.JPanel();
        txtNomeFuncionario = new javax.swing.JTextField();
        lblNomeFuncionario = new javax.swing.JLabel();
        lblCpf = new javax.swing.JLabel();
        txtCpf = new javax.swing.JTextField();
        txtCargo = new javax.swing.JTextField();
        lblCargo = new javax.swing.JLabel();
        lblSalario = new javax.swing.JLabel();
        txtSalario = new javax.swing.JTextField();
        lblLogin = new javax.swing.JLabel();
        txtLogin = new javax.swing.JTextField();
        lblCodFuncionario = new javax.swing.JLabel();
        txtCodFuncionario = new javax.swing.JTextField();
        lblSenha = new javax.swing.JLabel();
        txtSenha = new javax.swing.JPasswordField();
        lblSenha1 = new javax.swing.JLabel();
        txtConfirma = new javax.swing.JPasswordField();
        btnListarUsuarios = new javax.swing.JButton();
        btnMenuPrincipal = new javax.swing.JButton();
        btnFecharFrame = new javax.swing.JButton();
        lblBackground = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Cadastro de Usuário");
        setIconImage(Toolkit.getDefaultToolkit().getImage(getClass().getResource("/img/logopng32.png")));
        setMaximumSize(new java.awt.Dimension(1152, 648));
        setMinimumSize(new java.awt.Dimension(1152, 648));
        setPreferredSize(new java.awt.Dimension(1152, 648));
        setResizable(false);
        getContentPane().setLayout(null);

        pnlDadosFuncionario.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));
        pnlDadosFuncionario.setOpaque(false);
        pnlDadosFuncionario.setLayout(null);

        btnCadastrar.setText("Cadastrar");
        btnCadastrar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCadastrarActionPerformed(evt);
            }
        });
        pnlDadosFuncionario.add(btnCadastrar);
        btnCadastrar.setBounds(690, 150, 130, 30);

        btnLimpar.setText("Limpar");
        pnlDadosFuncionario.add(btnLimpar);
        btnLimpar.setBounds(560, 150, 100, 30);

        lblFuncionario.setForeground(new java.awt.Color(255, 0, 0));
        lblFuncionario.setText("Funcionário inexistente.");
        pnlDadosFuncionario.add(lblFuncionario);
        lblFuncionario.setBounds(410, 20, 210, 14);

        btnListarFuncionarios.setText("Listar Funcionários");
        btnListarFuncionarios.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnListarFuncionariosActionPerformed(evt);
            }
        });
        pnlDadosFuncionario.add(btnListarFuncionarios);
        btnListarFuncionarios.setBounds(620, 10, 150, 30);

        panDadosFunc.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createTitledBorder("Dados do Funcionário"), "Dados do funcionário")));
        panDadosFunc.setOpaque(false);
        panDadosFunc.setLayout(null);

        txtNomeFuncionario.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        txtNomeFuncionario.setFocusable(false);
        panDadosFunc.add(txtNomeFuncionario);
        txtNomeFuncionario.setBounds(150, 20, 256, 30);

        lblNomeFuncionario.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        lblNomeFuncionario.setText("Nome:");
        panDadosFunc.add(lblNomeFuncionario);
        lblNomeFuncionario.setBounds(60, 20, 70, 25);

        lblCpf.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        lblCpf.setText("CPF:");
        panDadosFunc.add(lblCpf);
        lblCpf.setBounds(60, 80, 40, 25);

        txtCpf.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        txtCpf.setFocusable(false);
        panDadosFunc.add(txtCpf);
        txtCpf.setBounds(150, 80, 214, 30);

        txtCargo.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        txtCargo.setFocusable(false);
        panDadosFunc.add(txtCargo);
        txtCargo.setBounds(150, 130, 193, 30);

        lblCargo.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        lblCargo.setText("Cargo:");
        panDadosFunc.add(lblCargo);
        lblCargo.setBounds(60, 130, 70, 25);

        lblSalario.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        lblSalario.setText("Salário:");
        panDadosFunc.add(lblSalario);
        lblSalario.setBounds(500, 50, 70, 25);

        txtSalario.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        txtSalario.setFocusable(false);
        panDadosFunc.add(txtSalario);
        txtSalario.setBounds(590, 40, 170, 30);

        pnlDadosFuncionario.add(panDadosFunc);
        panDadosFunc.setBounds(30, 190, 1010, 200);

        lblLogin.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        lblLogin.setText("Login:");
        pnlDadosFuncionario.add(lblLogin);
        lblLogin.setBounds(20, 60, 60, 25);

        txtLogin.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        txtLogin.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtLoginKeyReleased(evt);
            }
        });
        pnlDadosFuncionario.add(txtLogin);
        txtLogin.setBounds(90, 60, 280, 30);

        lblCodFuncionario.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        lblCodFuncionario.setText("Código do Funcionário:");
        pnlDadosFuncionario.add(lblCodFuncionario);
        lblCodFuncionario.setBounds(20, 10, 200, 25);

        txtCodFuncionario.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        txtCodFuncionario.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtCodFuncionarioKeyReleased(evt);
            }
        });
        pnlDadosFuncionario.add(txtCodFuncionario);
        txtCodFuncionario.setBounds(230, 10, 170, 30);

        lblSenha.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        lblSenha.setText("Senha:");
        pnlDadosFuncionario.add(lblSenha);
        lblSenha.setBounds(470, 60, 60, 25);

        txtSenha.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        txtSenha.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtSenhaKeyReleased(evt);
            }
        });
        pnlDadosFuncionario.add(txtSenha);
        txtSenha.setBounds(570, 60, 250, 31);

        lblSenha1.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        lblSenha1.setText("Confirmar:");
        pnlDadosFuncionario.add(lblSenha1);
        lblSenha1.setBounds(470, 110, 90, 25);

        txtConfirma.setFont(new java.awt.Font("Malgun Gothic", 0, 18)); // NOI18N
        txtConfirma.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtConfirmaKeyReleased(evt);
            }
        });
        pnlDadosFuncionario.add(txtConfirma);
        txtConfirma.setBounds(570, 110, 250, 31);

        btnListarUsuarios.setText("Listar Usuários");
        btnListarUsuarios.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnListarUsuariosActionPerformed(evt);
            }
        });
        pnlDadosFuncionario.add(btnListarUsuarios);
        btnListarUsuarios.setBounds(80, 110, 200, 30);

        getContentPane().add(pnlDadosFuncionario);
        pnlDadosFuncionario.setBounds(30, 30, 1100, 490);
        pnlDadosFuncionario.getAccessibleContext().setAccessibleName("Dados do funcionário");

        btnMenuPrincipal.setText("Menu Principal");
        btnMenuPrincipal.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnMenuPrincipalActionPerformed(evt);
            }
        });
        getContentPane().add(btnMenuPrincipal);
        btnMenuPrincipal.setBounds(900, 550, 130, 30);

        btnFecharFrame.setText("Fechar ");
        btnFecharFrame.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnFecharFrameActionPerformed(evt);
            }
        });
        getContentPane().add(btnFecharFrame);
        btnFecharFrame.setBounds(1050, 550, 80, 30);

        lblBackground.setIcon(new javax.swing.ImageIcon(getClass().getResource("/img/fundo.png"))); // NOI18N
        getContentPane().add(lblBackground);
        lblBackground.setBounds(0, -20, 1150, 650);

        pack();
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void btnCadastrarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCadastrarActionPerformed
        try {
            if (txtSenha.getText().trim().equals(txtConfirma.getText().trim())) {
                DaoUsuario dao = new DaoUsuario();
                Usuario user = new Usuario(Integer.parseInt(txtCodFuncionario.getText()), txtLogin.getText(), txtSenha.getText());
                try {
                    dao.cadastrarUsuario(user.getCodigoFuncionario(), user.getLogin(), user.getSenha());
                    JOptionPane.showMessageDialog(null, "Cadastrado!");
                } catch (SQLException ex) {
                    Logger.getLogger(FrmCadastroDespesa.class.getName()).log(Level.SEVERE, null, ex);
                } catch (ClassNotFoundException ex) {
                    Logger.getLogger(FrmCadastroDespesa.class.getName()).log(Level.SEVERE, null, ex);
                }
            } else {
                JOptionPane.showMessageDialog(null, "Senha não corresponde à confirmação de senha!");
            }
        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, "Erro: " + e.getMessage());
        }
    }//GEN-LAST:event_btnCadastrarActionPerformed

    private void btnListarUsuariosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnListarUsuariosActionPerformed
        control.Janelas.abrirListagemUsuario();
    }//GEN-LAST:event_btnListarUsuariosActionPerformed

    private void txtCodFuncionarioKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtCodFuncionarioKeyReleased
         txtCodFuncionario.setText(TextSize.maxLenghtFuncionario(txtCodFuncionario.getText()));
        Funcionario f = new Funcionario();
        DaoFuncionario dao = new DaoFuncionario();
        try {
            flagFuncionario = DaoFuncionario.existeFuncionario(txtCodFuncionario.getText());
            if (flagFuncionario) {
                f = DaoFuncionario.popularFuncionario(txtCodFuncionario.getText());
                lblFuncionario.setText("Funcionário encontrado.");
                lblFuncionario.setForeground(Color.BLACK);
                txtNomeFuncionario.setText(f.getPessoa().getNome());
                txtCpf.setText(f.getFisica().getCpf());
                txtCargo.setText(f.getCargo());
                txtSalario.setText("" + f.getSalarioSTR());
            } else {
                limparCampoFuncionario();
                flagFuncionario = false;
            }
        } catch (SQLException ex) {
            Logger.getLogger(FrmCadastroUsuario.class.getName()).log(Level.SEVERE, null, ex);
        } catch (ClassNotFoundException ex) {
            Logger.getLogger(FrmCadastroUsuario.class.getName()).log(Level.SEVERE, null, ex);
        }
       
    }//GEN-LAST:event_txtCodFuncionarioKeyReleased

    private void btnListarFuncionariosActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnListarFuncionariosActionPerformed
        control.Janelas.abrirListagemFuncionario();
    }//GEN-LAST:event_btnListarFuncionariosActionPerformed

    private void txtLoginKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtLoginKeyReleased
        txtLogin.setText(TextSize.maxLenghtLogin(txtLogin.getText()));
    }//GEN-LAST:event_txtLoginKeyReleased

    private void txtSenhaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtSenhaKeyReleased
        txtSenha.setText(TextSize.maxLenghtSenha(txtSenha.getText()));
    }//GEN-LAST:event_txtSenhaKeyReleased

    private void txtConfirmaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtConfirmaKeyReleased
        txtConfirma.setText(TextSize.maxLenghtSenha(txtConfirma.getText()));
    }//GEN-LAST:event_txtConfirmaKeyReleased

    private void btnMenuPrincipalActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnMenuPrincipalActionPerformed
        control.Janelas.focarPrincipal();
    }//GEN-LAST:event_btnMenuPrincipalActionPerformed

    private void btnFecharFrameActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnFecharFrameActionPerformed
        this.dispose();
    }//GEN-LAST:event_btnFecharFrameActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(FrmCadastroUsuario.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(FrmCadastroUsuario.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(FrmCadastroUsuario.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(FrmCadastroUsuario.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new FrmCadastroUsuario(control.SynchroSoft.getNvlAdm()).setVisible(true);
            }
        });
    }

    private void limparCampoFuncionario() {
        lblFuncionario.setText("Funcionário Inexistente.");
        lblFuncionario.setForeground(Color.red);
        txtNomeFuncionario.setText("");
        txtCpf.setText("");
        txtCargo.setText("");
        txtSalario.setText("");
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnCadastrar;
    private javax.swing.JButton btnFecharFrame;
    private javax.swing.JButton btnLimpar;
    private javax.swing.JButton btnListarFuncionarios;
    private javax.swing.JButton btnListarUsuarios;
    private javax.swing.JButton btnMenuPrincipal;
    private javax.swing.JLabel lblBackground;
    private javax.swing.JLabel lblCargo;
    private javax.swing.JLabel lblCodFuncionario;
    private javax.swing.JLabel lblCpf;
    private javax.swing.JLabel lblFuncionario;
    private javax.swing.JLabel lblLogin;
    private javax.swing.JLabel lblNomeFuncionario;
    private javax.swing.JLabel lblSalario;
    private javax.swing.JLabel lblSenha;
    private javax.swing.JLabel lblSenha1;
    private javax.swing.JPanel panDadosFunc;
    private javax.swing.JPanel pnlDadosFuncionario;
    private javax.swing.JTextField txtCargo;
    private javax.swing.JTextField txtCodFuncionario;
    private javax.swing.JPasswordField txtConfirma;
    private javax.swing.JTextField txtCpf;
    private javax.swing.JTextField txtLogin;
    private javax.swing.JTextField txtNomeFuncionario;
    private javax.swing.JTextField txtSalario;
    private javax.swing.JPasswordField txtSenha;
    // End of variables declaration//GEN-END:variables
}
